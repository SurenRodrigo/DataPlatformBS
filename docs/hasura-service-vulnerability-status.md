# Hasura Remediation Report
## Phase 2: Hasura GraphQL Engine Hardening

**Date:** 2025-11-16  
**Service:** Hasura GraphQL Engine  
**Upgrade Path:** v2.48.4 → v2.48.6

---

## Summary

**Status:** ✅ **SUCCESSFUL**

The Hasura upgrade from v2.48.4 to v2.48.6 resulted in a **massive reduction in vulnerabilities**:
- **Before:** 0 Critical, 0 High, **36 Medium** = 36 total
- **After:** 0 Critical, 0 High, **2 Medium** = 2 total
- **Improvement:** **94.4% reduction** in vulnerabilities (34 vulnerabilities eliminated)

---

## Step 2.1: Research Latest Hasura Version

### Findings

- **Latest v2.x Version:** v2.48.6
- **Release Date:** 2025-10-14
- **Current Version:** v2.48.4 (released 2025-08-19)
- **Version Type:** Patch release (v2.48.4 → v2.48.6)

### Compatibility Verification

✅ **PostgreSQL 15 Compatibility:** Confirmed
- Hasura v2.48.x series fully supports PostgreSQL 15
- No compatibility issues expected

✅ **Breaking Changes:** None
- v2.48.4 → v2.48.6 is a patch release
- No GraphQL API changes
- No configuration changes required

---

## Step 2.2: Test Hasura Upgrade

### Vulnerability Comparison

| Metric | v2.48.4 (Baseline) | v2.48.6 (Upgraded) | Change |
|--------|-------------------|-------------------|--------|
| **Critical** | 0 | 0 | ✅ No change |
| **High** | 0 | 0 | ✅ No change |
| **Medium** | 36 | 2 | ✅ **-34 (94.4% reduction)** |
| **Total** | 36 | 2 | ✅ **-34 vulnerabilities** |
| **Image Size** | 529 MB | 210 MB | ✅ **-319 MB (60% reduction)** |
| **Packages** | 216 | 217 | +1 package |

### Remaining Vulnerabilities (2 Medium)

Both remaining vulnerabilities are in base Ubuntu packages with no fixes available:

1. **pam** (1.4.0-11ubuntu2.6)
   - CVE-2025-8941
   - Status: Not fixed (base image issue)
   - Impact: Medium

2. **tar** (1.34+dfsg-1ubuntu0.1.22.04.2)
   - CVE-2025-45582
   - Status: Not fixed (base image issue)
   - Impact: Medium

**Note:** These vulnerabilities are in the base Ubuntu 22.04 image and cannot be fixed by upgrading Hasura. They would require a base image update from Hasura, which is outside our control.

### Vulnerabilities Eliminated (34 Medium)

The upgrade eliminated vulnerabilities in the following packages:
- python3.10 (6 vulnerabilities)
- gnutls28 (5 vulnerabilities)
- libssh (4 vulnerabilities)
- krb5 (3 vulnerabilities)
- sqlite3 (3 vulnerabilities)
- glibc (3 vulnerabilities)
- expat (2 vulnerabilities)
- perl (2 vulnerabilities)
- systemd (1 vulnerability)
- openssl (1 vulnerability)
- libcap2 (1 vulnerability)
- libtasn1-6 (1 vulnerability)
- gnupg2 (1 vulnerability)

---

## Configuration Changes

### Updated Files

1. **`platform/_env_sample`**
   - Changed: `HASURA_VERSION=v2.48.4` → `HASURA_VERSION=v2.48.6`

---

## Success Criteria Assessment

| Criteria | Target | Actual | Status |
|----------|--------|--------|--------|
| Critical Vulnerabilities | 0 | 0 | ✅ **PASS** |
| High Vulnerabilities | 0 | 0 | ✅ **PASS** |
| Medium Vulnerabilities | < 5 | 2 | ✅ **PASS** |
| Service Functionality | Maintained | Verified | ✅ **PASS** |

---

## Final Verification Results

### Step 2.4: Final Docker Scout Scan

**Final Scan Results:**
- **Critical:** 0 ✅
- **High:** 0 ✅
- **Medium:** 2 ✅
- **Total:** 2 vulnerabilities

**Remaining Vulnerabilities:**
1. pam - CVE-2025-8941 (not fixed - base image issue)
2. tar - CVE-2025-45582 (not fixed - base image issue)

### Phase 2 Completion Status

1. ✅ **Step 2.1:** Research Latest Hasura Version - COMPLETED
2. ✅ **Step 2.2:** Test Hasura Upgrade - COMPLETED
3. ✅ **Step 2.3:** Verify Functionality - COMPLETED
4. ✅ **Step 2.4:** Final Verification - COMPLETED

**Status:** ✅ **PHASE 2 COMPLETE - READY FOR COMMIT**

---

## Notes

- The upgrade from v2.48.4 to v2.48.6 is a patch release, so no breaking changes are expected
- The 2 remaining Medium vulnerabilities are in base Ubuntu packages and cannot be fixed by upgrading Hasura
- Image size reduced significantly (529 MB → 210 MB), which is an additional benefit
- All eliminated vulnerabilities were in system packages that were updated in the newer Hasura base image

---

## Recommendations

1. ✅ **Upgrade completed:** The vulnerability reduction is significant and meets all success criteria
2. **Monitor base image:** The 2 remaining vulnerabilities are in the base Ubuntu image; monitor for future Hasura releases that may use updated base images
3. ✅ **Functional testing:** Completed - all functionality verified

## Files Changed

1. `platform/_env_sample` - Updated `HASURA_VERSION` from `v2.48.4` to `v2.48.6`

## Commit Message Suggestion

```
feat(platform): Upgrade Hasura from v2.48.4 to v2.48.6

- Reduced vulnerabilities from 36 Medium to 2 Medium (94.4% reduction)
- Achieved 0 Critical and 0 High vulnerabilities
- Image size reduced from 529 MB to 210 MB (60% reduction)
- All functionality verified and working correctly
- Remaining 2 Medium vulnerabilities are in base Ubuntu image (not fixable via Hasura upgrade)

Phase 2: Hasura Remediation - COMPLETE
```

