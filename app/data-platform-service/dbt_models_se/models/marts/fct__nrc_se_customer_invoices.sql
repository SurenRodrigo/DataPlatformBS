SELECT
    {{ dbt_utils.generate_surrogate_key(['id', 'invoice_no']) }} AS invoice_sk,
    id,
    invoice_no,
    invoice_number,
    ext_invoice_no,
    title,
    description,
    project_id,
    project_no,
    customer_id,
    customer_name,
    customer_type_name,
    customer_vat_no,
    customer_ref,
    customer_ref_2,
    customer_contact_id,
    customer_contact_name,
    invoice_type_id,
    invoice_type_name,
    invoice_status_code,
    invoice_status_name,
    invoice_date,
    ledger_date,
    due_date,
    bill_terms,
    bill_terms_code,
    bill_terms_days,
    our_ref,
    contract_no,
    invoice_amount,
    net_amount,
    original_net_amount,
    vat_amount,
    customer_amount,
    total_work_cost,
    tax_reduction_id,
    tax_reduction_amount,
    credit_invoice_id,
    bill_address_1,
    bill_address_2,
    bill_address_3,
    bill_address_4,
    bill_address_5,
    bill_address_6,
    edi_status,
    is_no_vat,
    is_locked,
    is_credit_note,
    is_hide_code_no,
    is_hide_markup,
    is_vat_invoice,
    is_contractor_vat,
    is_locked_to_source,
    is_ready_for_invoice,
    created_at,
    last_modified_at
FROM {{ ref('stg__next_erp_customer_invoices') }}

